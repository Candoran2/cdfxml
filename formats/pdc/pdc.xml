<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE niftoolsxml>
<niftoolsxml version="0.9.3.0">

    <!-- Basic Types -->

    <basic name="biguint32" integral="true" countable="true" size="4" >
        A big-endian unsigned 32-bit integer.
    </basic>

    <basic name="bigushort" integral="true" countable="true" size="2" convertible="biguint32" >
        A big-endian unsigned 16-bit integer.
    </basic>

    <basic name="ubyte" boolean="true" integral="true" countable="true" size="1" convertible="biguint32 bigushort" >
        An unsigned 8-bit integer.
    </basic>

    <basic name="char" integral="true" countable="false" size="1" >
        An 8-bit character.
    </basic>

    <basic name="LineString" integral="false" >
        A variable length string that ends with a newline character (0x0A).
    </basic>

    <!-- Struct Types -->

    <struct name="FixedString" >
        <field name="Data" type="char" length="#ARG#"></field>
    </struct>

    <struct name="SizedString" generic="true" >
        A string of given length.
        <field name="Length" type="#T#">The string length.</field>
        <field name="Value" type="char" length="Length">The string itself.</field>
    </struct>

    <!-- PDC file-specific -->

    <struct name="CharacterEntry">
        <field name="Values" type="SizedString" length="4" template="bigushort" ></field>
    </struct>

    <struct name="G2PB" >
        <field name="Magic" type="FixedString" arg="4" >"G2PB"</field>
        <field name="Unknown 1" type="ubyte" length="7" >20 02 09 05 00 00 00, same in every file</field>
        <field name="Num Character Map Groups" type="ubyte" >Byte that varies for files. Seemingly always one more than alphabet size.</field>
        <field name="Unknown 2" type="ubyte" length="1" ></field>
        <field name="Alphabet Size" type="ubyte" ></field>
        <field name="Alphabet" type="char" length="Alphabet Size" ></field>
        <field name="Character Map Groups" type="biguint32" length="Num Character Map Groups" >How many character maps per group</field>
        <field name="Num Words" type="biguint32" ></field>
        <field name="Unknown Ints 2" type="biguint32" length="1" ></field>
        <field name="Unknown Byte 2" type="ubyte" ></field>
        <field name="Character Map" type="CharacterEntry" length="Num Character Map Groups" width="Character Map Groups" ></field>
        <field name="Small Words" type="SizedString" template="bigushort" length="Num Words" ></field>
        <field name="Alphabet Groups" type="SizedString" template="bigushort" length="8" >Seemingly always 8 with the last one empty.</field>
        One more byte and an array of bigushort words again.
        More broken words or words with accents/groupings, ended with ENDG2P : g2p likely stands for Grapheme to Phoneme
    </struct>

    <struct name="PDCWordList">
        <field name="Num Words" type="biguint32">Number of words</field>
        Accented/foreign language letters
        Word list starts at around 0xE320
        Ends at around 0x247A60 (with an END)
    </struct>

    <struct name="PDCFile" >
        <field name="Magic" type="LineString">DCC</field>
        <field name="Version" type="LineString">Version 112</field>
        <field name="Copyright" type="LineString">Copyright notice</field>
        <field name="Num Words" type="LineString">String describing number of words.</field>
        <field name="Rules Included" type="LineString">String saying "Rules Included"</field>
        <field name="Header End" type="LineString">String saying "END_OF_HEADER"</field>
        <field name="Unknown Bytes 1" type="ubyte" length="2">1A 01 in all files</field>
        <field name="G2PB" type="G2PB"></field>
    </struct>

</niftoolsxml>